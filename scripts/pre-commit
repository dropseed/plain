#!/bin/sh -e
BOLD=$(tput bold)
NORMAL=$(tput sgr0)

echo "${BOLD}Checking formatting and linting${NORMAL}"
./scripts/fix --check

echo ""
echo "${BOLD}Validating type annotations${NORMAL}"
./scripts/type-validate

echo ""
echo "${BOLD}Running tests${NORMAL}"
./scripts/test

echo ""
echo "${BOLD}Running preflight in example${NORMAL}"
source scripts/start-postgres plain_example
PGPASSWORD=postgres createdb -h localhost -U postgres plain_example 2>/dev/null || true
cd example && uv run plain preflight
