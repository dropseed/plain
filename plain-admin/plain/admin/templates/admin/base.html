{% use_elements %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        {%- if title|default('') -%}
            {{ title }} - {{ app_name }} Admin
        {%- else -%}
            {{ app_name }} Admin
        {%- endif -%}
    </title>
    {% tailwind_css %}
    {% htmx_js %}
    <link href="{{ asset('admin/admin.css') }}" rel="stylesheet">
    <script src="{{ asset('admin/vendor/jquery-3.7.1.min.js') }}" nonce="{{ request.csp_nonce }}"></script>
    <script src="{{ asset('admin/vendor/chart.js') }}" defer nonce="{{ request.csp_nonce }}"></script>
    <script src="{{ asset('admin/charts.js') }}" defer nonce="{{ request.csp_nonce }}"></script>
    <script src="{{ asset('admin/admin.js') }}" defer nonce="{{ request.csp_nonce }}"></script>
    <script src="{{ asset('admin/menu.js') }}" defer nonce="{{ request.csp_nonce }}"></script>
    <script src="{{ asset('admin/vendor/popper.min.js') }}" defer nonce="{{ request.csp_nonce }}"></script>
    <link href="{{ asset('admin/vendor/tippy.css') }}" rel="stylesheet">
    <script src="{{ asset('admin/vendor/tippy.umd.min.js') }}" defer nonce="{{ request.csp_nonce }}"></script>
    {% block header_scripts %}{% endblock %}
</head>
<body
    class="flex flex-col min-h-screen bg-white pb-12"
    {% if is_package_installed('plaintoolbar') %}data-toolbar-installed{% endif %}
    >

    <div class="plain-admin flex flex-col flex-1">
    {% include "admin/_header.html" %}

    <div class="flex flex-1 min-h-[calc(100vh-5.5rem)]"> <!-- h-11 + h-11 = 5.5rem -->
        <div id="plain-admin-content" class="w-full min-w-0 bg-white text-black/90 flex-grow">
            <header class="px-4 lg:px-8 inset-x-0 pt-6 pb-4">
                {% block header %}
                {# Breadcrumbs - small, above title #}
                {% if parent_view_classes or view_class.nav_section %}
                <nav class="flex items-center space-x-1.5 mb-1 text-xs text-black/50" aria-label="Breadcrumb">
                    {% for parent_view in parent_view_classes|reverse %}
                        {% if loop.first and parent_view.nav_section %}
                            <span class="text-black/40">{{ parent_view.nav_section }}</span>
                            <span class="text-black/30">/</span>
                        {% endif %}
                        <a href="{{ parent_view.get_view_url(object if object is defined else None) }}" class="hover:text-black/70 hover:underline">
                            {{ parent_view.get_nav_title() }}
                        </a>
                        <span class="text-black/30">/</span>
                    {% endfor %}
                    {% if object is defined and parent_view_classes %}
                        <span class="text-black/60 truncate max-w-48">{{ object.__repr__() }}</span>
                    {% elif view_class.nav_section and not parent_view_classes %}
                        <span class="text-black/40">{{ view_class.nav_section }}</span>
                    {% endif %}
                </nav>
                {% endif %}

                {# Title row with actions #}
                <div class="flex items-center justify-between gap-3">
                    <div class="flex items-center gap-3 min-w-0">
                        {% block image %}
                            {% if image %}
                            <img src="{{ image.src }}" alt="{{ image.alt }}" class="h-8 rounded flex-shrink-0">
                            {% endif %}
                        {% endblock %}
                        <h1 class="font-semibold text-2xl truncate">{% block title %}{{ title }}{% endblock %}</h1>
                    </div>
                    {# Desktop actions #}
                    <div class="hidden sm:flex items-center space-x-2 text-sm flex-shrink-0">
                        {% block actions %}{% endblock %}
                        {% for link, url in links.items() %}
                        <a href="{{ url }}" class="plain-btn">{{ link }}</a>
                        {% endfor %}
                    </div>
                    {# Mobile actions dropdown #}
                    {% if links %}
                    <div class="sm:hidden flex-shrink-0">
                        <button type="button" data-dropdown class="flex items-center justify-center w-8 h-8 rounded hover:bg-stone-100">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="text-stone-600" viewBox="0 0 16 16">
                                <path d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3m5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3"/>
                            </svg>
                            <template>
                                <div class="py-1">
                                    {% for link, url in links.items() %}
                                    <a href="{{ url }}" class="block px-4 py-2 text-sm text-stone-700 hover:bg-stone-100 rounded">
                                        {{ link }}
                                    </a>
                                    {% endfor %}
                                </div>
                            </template>
                        </button>
                    </div>
                    {% endif %}
                </div>
                {# Description - shown below title #}
                {% if description %}
                <p class="mt-1 text-sm text-black/50">{{ description }}</p>
                {% endif %}
                {% endblock %}
            </header>

            {% if cards %}
            <div class="px-4 mt-4 lg:px-8">
                <div class="grid grid-cols-2 items-start gap-4 mt-4 lg:grid-cols-4 [&>aside]:col-span-1 [&>aside.col-span-2]:col-span-2 [&>aside.col-span-3]:col-span-2 lg:[&>aside.col-span-3]:col-span-3 [&>aside.col-span-4]:col-span-2 lg:[&>aside.col-span-4]:col-span-4">
                    {% for card in cards %}
                        {{ render_card(card)|safe }}
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <main class="px-4 pt-6 pb-6 lg:px-8 text-black/70">{% block content %}{% endblock %}</main>
        </div>

    </div>

    </div><!-- /.plain-admin -->

    {% if is_package_installed('plaintoolbar') %}
        {% toolbar %}
    {% endif %}
</body>
</html>
